var idDepartamento,token=$("meta[name='_csrf']").attr("content");function guardarDepartamento(){limpiarErrores();var e=$("#departamento").val(),a=document.getElementById("select_facultad_departamento").value,t={};t.id=idDepartamento,t.departamento=e,"0"!=a&&(t.facultad={},t.facultad.id=a);var r=validateInputTextRequerido("departamento","errorDepartamento"),n=validateLengthTxt("departamento","errorDepartamento",100),o=validateSelect("select_facultad_departamento","errorSelectFacultad");r&&n&&o&&0!=a?(showSpinnerModal("btnSaveAreas","btnSpinnerAreas"),$.ajax({headers:{"X-CSRF-TOKEN":token},type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),url:contextPath+"/departamentos-academicos/save",cache:!1,success:function(e){toastr.success("Se ha guardado la informaciÃ³n","Excelente!"),idFacultad=null,paginadorLoadAjax(contextPath+"/departamentos-academicos/reload"),$("#select_facultad_filtro_departamento").val(0),$("#modalRegistroDepartamento").modal("hide"),hideSpinnerModal("btnSaveAreas","btnSpinnerAreas")},error:function(e){hideSpinnerModal("btnSaveAreas","btnSpinnerAreas"),e.responseJSON.length>0?(toastr.error("No se pudo procesar la solicitud...","Error!"),e.responseJSON.forEach(function(e){if("departamento"==e.field){var a=document.getElementById("departamento");document.getElementById("errorDepartamento").innerText=e.defaultMessage,a.classList.add("is-invalid")}if("facultad"==e.field){var t=document.getElementById("select_facultad_departamento");document.getElementById("errorSelectFacultad").innerText=e.defaultMessage,t.classList.add("is-invalid")}})):toastr.error(e.responseJSON.message,"Error!")}})):toastr.error("Diligencie el formulario correctamente, los campos son requeridos","Error!")}function editarDepartamento(e){$.ajax({headers:{"X-CSRF-TOKEN":token},type:"GET",contentType:"application/json; charset=utf-8",url:contextPath+"/departamentos-academicos/search/"+e.dataset.id,cache:!1,success:function(e){$("#modalRegistroDepartamento").modal(),$("#departamento").val(e.departamento),$("#select_facultad_departamento").val(e.facultad.id),$("#select_facultad_departamento").select2().trigger("change"),idDepartamento=e.id},error:function(e){toastr.error(e.responseJSON.message,"Error!")}})}function limpiarErrores(){var e=document.getElementById("select_facultad_departamento");document.getElementById("errorSelectFacultad").innerText="",e.classList.remove("is-invalid");var a=document.getElementById("departamento");document.getElementById("errorDepartamento").innerText="",a.classList.remove("is-invalid")}$(document).ready(function(){$("#modalRegistroDepartamento").on("show.bs.modal",function(e){$("#departamento").val(""),$("#select_facultad_departamento").val(0).trigger("change"),idDepartamento=0,limpiarErrores()}),$("#select_facultad_filtro_departamento").on("change",function(e){e.preventDefault();var a=$(this).find("option:selected").text();if(0==$(this).find("option:selected").val())paginadorLoadAjax(contextPath+"/departamentos-academicos/reload");else{var t=contextPath+"/departamentos-academicos/reload?facultad=".concat(a.replace(/ /gi,"%20"));paginadorLoadAjax(t)}}),$("#select_facultad_departamento").on("change",function(e){e.preventDefault(),validateSelect("select_facultad_departamento","errorSelectFacultad")})});