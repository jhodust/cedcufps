var nombre,fechaInicio,fechaFin,duracion,fechaLimInscripcion,cantMaxParticipantes,costoInscripcion,lugar,costoEducacionContinua,requisitos,objetivo,porcentajeAsistencia,resumen,contenidoGeneral,idTipoEduContinua,tipoEduContinua,idProgramaResponsable,idDocenteResponsable,idClasificacionCine,consecutivo,token=$("meta[name='_csrf']").attr("content");function validDuracion(e){var a=$("#selectTipoContinua").find("option:selected"),n=document.getElementById("duracion"),i=document.getElementById("errDuracionEdc"),c=document.getElementById("btnGuardarEdC");return 1==a.val()||4==a.val()?16>e.trim()?(i.innerText="El "+a.text()+" debe tener m\xednimo 16 horas de duraci\xf3n",n.classList.add("is-invalid"),c.disabled=!0,!1):(i.innerText="",n.classList.remove("is-invalid"),c.disabled=!1,!0):2==a.val()?90>e.trim()?(i.innerText="El "+a.text()+" debe tener m\xednimo 90 horas de duraci\xf3n",n.classList.add("is-invalid"),c.disabled=!0,!1):(i.innerText="",n.classList.remove("is-invalid"),c.disabled=!1,!0):""==e.trim()?(i.innerText="El campo es requerido",n.classList.add("is-invalid"),c.disabled=!0,!1):(i.innerText="",n.classList.remove("is-invalid"),c.disabled=!1,!0)}$(document).ready(function(){$("#selectEdCBase").on("select2:select",function(e){findEducacionContinuaBase(e.params.data.id)}),$("#selectProgramaBase").on("select2:select",function(e){loadListEduContinuaBase(e.params.data.id)}),$("#selectTipoContinua").select2({tags:!0,createTag:function(e){return{id:-1,text:e.term,newTag:!0}}}),$("#selectTipoContinua").on("change",function(e){e.preventDefault(),validateSelect("selectTipoContinua","errTipoEdc");var a=$(this).find("option:selected"),n=document.getElementById("duracion"),i=document.getElementById("errDuracionEdc"),c=document.getElementById("btnGuardarEdC");"1"==a.val()||"4"==a.val()?n.value<16&&(i.innerText="El "+a.text()+" debe tener m\xednimo 16 horas de duraci\xf3n",n.classList.add("is-invalid"),c.disabled=!0):2==a.val()?n.value<90&&(i.innerText="El "+a.text()+" debe tener m\xednimo 90 horas de duraci\xf3n",n.classList.add("is-invalid"),c.disabled=!0):(i.innerText="",n.classList.remove("is-invalid"),c.disabled=!1)}),$("#selectClasificacionCINE").on("change",function(e){e.preventDefault(),validateSelect("selectClasificacionCINE","errClasificacionEdc")}),$("#programaResponsable").on("change",function(e){e.preventDefault(),validateSelect("programaResponsable","errProgRespEdc")}),$("#docenteResponsable").on("change",function(e){e.preventDefault(),validateSelect("docenteResponsable","errDocRespEdc")}),$("#selectTipoBeneficiarios").on("change",function(e){e.preventDefault(),validateSelect("selectTipoBeneficiarios","errTipoBenefEdc")}),$("#duracion").keyup(function(e){validDuracion(e.target.value)}),$("#fechaLimInscripcionEduCont").flatpickr({enableTime:!0,dateFormat:"d/m/Y H:i",minDate:null!=fLim&&new Date(fLim)<new Date?new Date(fLim):new Date,defaultDate:fechaLimInscripcionEvento,maxDate:fechaFinEvento});var e=[];e.push(new Date),e.push(fIni),$("#fechaInicioEduCont").flatpickr({enableTime:!0,dateFormat:"d/m/Y H:i",minDate:null!=fIni&&new Date(fIni)<new Date?new Date(fIni):new Date,defaultDate:fechaInicioEvento,plugins:[new rangePlugin({input:"#fechaFinEduCont",enableTime:!0,dateFormat:"d/m/Y H:i",defaultDate:fechaFinEvento})]}),$("#cbEdCExistente").click(function(){document.getElementById("cbEdCExistente").checked?document.getElementById("divEdCBase").style.display="block":($("#selectProgramaBase").val("0").trigger("change"),clearSelectEduContinuaBase(),clearEduContinuaBase(),document.getElementById("divEdCBase").style.display="none"),clearErrors()})});var idTipoBeneficiarios=[];function showLoader(){try{document.getElementById("divLoader").style.display="flex",document.getElementById("formEducacionContinua").style.display="none",document.getElementById("formEducacionContinuaBase").style.display="none"}catch(e){}}function hideLoader(){try{document.getElementById("divLoader").style.display="none",document.getElementById("formEducacionContinua").style.display="inline",document.getElementById("formEducacionContinuaBase").style.display="inline"}catch(e){}}function guardarEdc(){ajaxSaveEducacionContinua()}function ajaxSaveEducacionContinua(){listTipoBen=[],$("#selectTipoBeneficiarios").val().forEach(e=>{listTipoBen.push(e)}),idTipoBeneficiarios=listTipoBen;var e,a,n=$("#nombreEdc").val(),i=$("#fechaInicioEduCont").val(),c=$("#fechaFinEduCont").val(),o=$("#duracion").val(),t=$("#fechaLimInscripcionEduCont").val(),r=$("#cantMaxPartEdc").val(),d=$("#costoInscripcionEdc").val(),s=$("#lugarEdc").val(),l=$("#costoTotalEdc").val(),u=$("#porcentajeAsistenciaEdc").val(),p=$("#selectTipoContinua").select2("data")[0].id,E=$("#selectTipoContinua").select2("data")[0].text;e=null!=document.getElementById("programaResponsable")?$("#programaResponsable").val():eduContinua.idProgramaResp,a=null!=document.getElementById("docenteResponsable")?$("#docenteResponsable").val():eduContinua.idDocenteResp;var f,m=$("#selectClasificacionCINE").val(),v=$("#infoAdicionalEdC").val(),g=validateInputTextRequerido("nombreEdc","errNombreEdc"),C=validateLengthTxt("nombreEdc","errNombreEdc",150),h=validateInputTextRequerido("fechaInicioEduCont","errFechaInicioEdc"),b=validateInputTextRequerido("fechaFinEduCont","errFechaFinEdc"),T=validateInputTextRequerido("fechaLimInscripcionEduCont","errFechaLimInscEdc"),B=validateInputNumberRequerido("duracion","errDuracionEdc"),I=validateInputNumberRequerido("costoTotalEdc","errCostoTotalEdc"),y=validDuracion(o),R=validateInputNumberNotRequired("costoInscripcionEdc","errCostoInscripEdc"),x=validateInputNumberNotRequired("cantMaxPartEdc","errCantPartEdc"),D=validateInputPorcentaje("porcentajeAsistenciaEdc","errPorcAsisEdc"),L=validateInputTextRequerido("lugarEdc","errLugarEdc"),_=validateLengthTxt("lugarEdc","errLugarEdc",40),P=validateSelect("selectTipoContinua","errTipoEdc"),F=validateSelect("selectTipoBeneficiarios","errTipoBenefEdc"),j=validateSelect("selectClasificacionCINE","errClasificacionEdc");null!=document.getElementById("programaResponsable")&&(f=validateSelect("programaResponsable","errProgRespEdc")),null!=document.getElementById("docenteResponsable")&&(w=validateSelect("docenteResponsable","errDocRespEdc"));var w=validateSelect("docenteResponsable","errDocRespEdc");if(g&&C&&h&&b&&T&&B&&y&&I&&R&&x&&D&&L&&_&&P&&F&&j&&(null==f||f)&&(null==w||w)){var N=$("#inputImagenEvento")[0].files,S=new FormData;S.append("imagen",N[0]),S.append("id",idEduContinua),S.append("nombre",n),S.append("fechaInicio",i),S.append("fechaFin",c),S.append("duracion",o),S.append("fechaLimInscripcion",t),""!=r.trim()&&S.append("cantMaxParticipantes",r),""!=d.trim()&&S.append("costoInscripcion",d),S.append("lugar",s),S.append("costoEducacionContinua",l),S.append("porcentajeAsistencia",u),S.append("idTipoEduContinua",p),S.append("tipoEduContinua",E),S.append("idProgramaResponsable",e),S.append("idDocenteResponsable",a),S.append("idClasificacionCine",m),S.append("idTipoBeneficiarios",idTipoBeneficiarios),S.append("infoAdicional",v),null!=consecutivo&&S.append("consecutivo",consecutivo),showSpinnerModal("btnGuardarEdC","btnSpinnerEdC"),$.ajax({headers:{"X-CSRF-TOKEN":token},url:contextPath+"/educacion-continua/save",type:"POST",data:S,enctype:"multipart/form-data",processData:!1,contentType:!1,cache:!1,success:function(e){toastr.success("Se ha guardado la informaci\xf3n","Excelente!"),0==idEduContinua?window.setTimeout(function(){window.location.href=contextPath+"/educacion-continua"},1e3):(reloadDetalles(),hideSpinnerModal("btnGuardarEdC","btnSpinnerEdC"),$('[href="#pills-detalles"]').tab("show"))},error:function(e){hideSpinnerModal("btnGuardarEdC","btnSpinnerEdC"),e.responseJSON.length>0?(toastr.error("No se pudo procesar la solicitud...","Error!"),e.responseJSON.forEach(function(e){if("facultad"==e.field){var a=document.getElementById("facultad");document.getElementById("errorFacultad").innerText=e.defaultMessage,a.classList.add("is-invalid")}})):toastr.error(e.responseJSON.message,"Error!")}})}else toastr.error("Debes diligenciar el formulario correctamente","Error!")}function findEducacionContinuaBase(e){$.ajax({headers:{"X-CSRF-TOKEN":token},url:contextPath+"/educacion-continua/search-base",type:"GET",data:{nombreEdC:e},contentType:"application/json; charset=utf-8",cache:!1,success:function(e){loadEduContinuaBase(e)},error:function(e){}})}function loadListEduContinuaBase(e){clearSelectEduContinuaBase(),$.ajax({headers:{"X-CSRF-TOKEN":token},url:contextPath+"/educacion-continua/search-educaciones-continuas-base",type:"GET",data:{idPrograma:e},contentType:"application/json; charset=utf-8",cache:!1,success:function(e){e.forEach(function(e){var a=new Option(e,e,!1,!1);$("#selectEdCBase").append(a)})},error:function(e){}})}function clearSelectEduContinuaBase(){$("#selectEdCBase").empty().trigger("change");var e=new Option("Seleccione...","0",!1,!1);$("#selectEdCBase").append(e).trigger("change")}function loadEduContinuaBase(e){if($("#nombreEdc").val(e.nombre),$("#duracion").val(e.duracion),$("#costoTotalEdc").val(e.costoEducacionContinua),$("#costoInscripcionEdc").val(e.costoInscripcion),$("#cantMaxPartEdc").val(e.cantMaxParticipantes),$("#porcentajeAsistenciaEdc").val(e.porcentajeAsistencia),$("#lugarEdc").val(e.lugar),$("#infoAdicionalEdC").summernote("code",e.infoAdicional),!e.estadoOficialTipoEducacionContinua){var a=new Option(e.tipoEduContinua,e.idTipoEduContinua,!1,!1);$("#selectTipoContinua").append(a)}$("#selectTipoContinua").val(e.idTipoEduContinua).trigger("change"),$("#selectClasificacionCINE").val(e.idClasificacion).trigger("change"),$("#programaResponsable").val(e.idProgramaResp).trigger("change"),$("#docenteResponsable").val(e.idDocenteResp).trigger("change");var n=[];e.tipoBeneficiarios.forEach(e=>n.push(e.id)),$("#selectTipoBeneficiarios").val(n).trigger("change"),consecutivo=e.consecutivo}function clearEduContinuaBase(){$("#nombreEdc").val(""),$("#duracion").val(""),$("#costoTotalEdc").val(""),$("#costoInscripcionEdc").val(""),$("#cantMaxPartEdc").val(""),$("#porcentajeAsistenciaEdc").val(""),$("#lugarEdc").val(""),$("#requisitosEdc").val(""),$("#objetivoEdc").val(""),$("#contenidoGeneralEdc").val(""),$("#resumenEdc").val(""),$("#selectTipoContinua").val("0").trigger("change"),$("#selectClasificacionCINE").val("0").trigger("change"),$("#programaResponsable").val("0").trigger("change"),$("#selectTipoBeneficiarios").val([]).trigger("change"),consecutivo=void 0}function clearErrors(){cleanError("selectTipoContinua","errTipoEdc"),cleanError("nombreEdc","errNombreEdc"),cleanError("selectClasificacionCINE","errClasificacionEdc"),cleanError("fechaInicioEduCont","errFechaInicioEdc"),cleanError("fechaFinEduCont","errFechaFinEdc"),cleanError("duracion","errDuracionEdc"),cleanError("costoTotalEdc","errCostoTotalEdc"),cleanError("programaResponsable","errProgRespEdc"),cleanError("docenteResponsable","errDocRespEdc"),cleanError("selectTipoBeneficiarios","errTipoBenefEdc"),cleanError("fechaLimInscripcionEduCont","errFechaLimInscEdc"),cleanError("costoInscripcionEdc","errCostoInscripEdc"),cleanError("cantMaxPartEdc","errCantPartEdc"),cleanError("porcentajeAsistenciaEdc","errPorcAsisEdc"),cleanError("lugarEdc","errLugarEdc")}function reloadDetalles(){var e=contextPath+"/educacion-continua/detalles/reload/"+eduContinua.idAcceso;$("#detallesEdC").load(e)}