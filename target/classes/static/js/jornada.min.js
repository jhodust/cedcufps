var idJornada,
    horaInicioPick,
    horaFinPick,
    token = $("meta[name='_csrf']").attr("content"),
    idEducacionContinua = eduContinua.id;
function guardarJornada() {
    var a = $("#horaInicio").val(),
        n = $("#horaFin").val();
    limpiarErrores();
    var e = {};
    (e.id = idJornada), (e.horaInicio = a), (e.horaFin = n), (e.idEducacionContinua = idEducacionContinua), ajaxGuardarJornada(e);
}
function ajaxGuardarJornada(a) {
    showSpinnerModal("btnSaveJornada", "btnSpinnerJornada"),
        $.ajax({
            headers: { "X-CSRF-TOKEN": token },
            type: "POST",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(a),
            url: contextPath + "/educacion-continua/jornadas/save",
            cache: !1,
            success: function (a) {
                toastr.success("Se ha guardado la informaci√≥n", "Excelente!"), (idJornada = null), $("#modalRegistroJornada").modal("hide"), reloadListJornadas(), hideSpinnerModal("btnSaveJornada", "btnSpinnerJornada");
            },
            error: function (a) {
                hideSpinnerModal("btnSaveJornada", "btnSpinnerJornada"),
                    toastr.error("No se pudo procesar la solicitud...", "Error!"),
                    a.responseJSON.forEach(function (a) {
                        if ("horaInicio" == a.field) {
                            var n = document.getElementById("horaInicio");
                            (document.getElementById("errorHoraInicio").innerText = a.defaultMessage), n.classList.add("is-invalid");
                        }
                        if ("horaFin" == a.field) {
                            var e = document.getElementById("horaFin");
                            (document.getElementById("errorHoraFin").innerText = a.defaultMessage), e.classList.add("is-invalid");
                        }
                    });
            },
        });
}
function editarJornada(a) {
    $.ajax({
        headers: { "X-CSRF-TOKEN": token },
        type: "GET",
        contentType: "application/json; charset=utf-8",
        url: contextPath + "/educacion-continua/jornadas/search/" + a.dataset.id,
        cache: !1,
        success: function (a) {
            $("#modalRegistroJornada").modal(),
                $("#horaInicio").val(a.fechaJornadaString + " " + a.horaInicioString),
                $("#horaFin").val(a.fechaJornadaString + " " + a.horaFinString),
                (idJornada = a.id),
                (document.getElementById("horaFin").disabled = !0);
        },
        error: function (a) {},
    });
}
function eliminarJornada(a) {
    $.ajax({
        headers: { "X-CSRF-TOKEN": token },
        type: "GET",
        contentType: "application/json; charset=utf-8",
        data: { id: a.dataset.id },
        url: contextPath + "/educacion-continua/jornadas/delete",
        cache: !1,
        success: function (a) {
            toastr.success(a, "Excelente!"), reloadListJornadas();
        },
        error: function (a) {
            toastr.error(a.responseJSON.message, "Error!");
        },
    });
}
function limpiarErrores() {
    var a = document.getElementById("horaInicio");
    (document.getElementById("errorHoraInicio").innerText = ""), a.classList.remove("is-invalid");
    var n = document.getElementById("horaFin");
    (document.getElementById("errorHoraFin").innerText = ""), n.classList.remove("is-invalid");
}
function reloadListJornadas() {
    var a = contextPath + "/educacion-continua/jornadas/" + idEducacionContinua;
    $("#div_list_jornadas").load(a);
    var n = contextPath + "/educacion-continua/jornadas/detalles/" + idEducacionContinua;
    $("#div_list_detalles_jornadas").load(n), refreshTableAsistentes();
}
$(document).ready(function () {
    (document.getElementById("horaFin").disabled = !0),
        (horaInicioPick = $("#horaInicio").flatpickr({
            enableTime: !0,
            dateFormat: "d/m/Y H:i",
            disableMobile: "true",
            onChange: function (a, n, e) {
                (document.getElementById("horaFin").disabled = !1),
                    (horaFinPick = $("#horaFin").flatpickr({
                        enableTime: !0,
                        disableMobile: "true",
                        dateFormat: "d/m/Y H:i",
                        minDate: a[0].toLocaleString(),
                        minTime: a[0].toTimeString(),
                        maxDate: fechaFEvento,
                        defaultDate: a[0].toLocaleString(),
                    }));
            },
            minDate: fechaIEvento,
            maxDate: fechaFEvento,
            defaultDate: fechaIEvento,
        })),
        $("#modalRegistroJornada").on("show.bs.modal", function (a) {
            $("#horaInicio").val(""), $("#horaFin").val(""), (idJornada = null), (document.getElementById("horaFin").disabled = !0);
        });
});
